<?php\n/**\n * Admin Dashboard\n * \n * Administrative interface for system management and analytics\n */\n\nrequire_once 'db.php';\nrequire_once 'src/Auth.php';\nrequire_once 'src/DB.php';\n\n$auth = new Auth($conn);\n$db = new DB($conn);\n\n// Check login\nif (!$auth->isLoggedIn()) {\n    header('Location: login_fixed.php');\n    exit;\n}\n\n// For now, only allow user ID 1 (admin)\nif ($_SESSION['user_id'] != 1) {\n    echo '<h2>Access Denied</h2><p>Admin access only</p>';\n    exit;\n}\n\n// Get statistics\n$totalUsers = $db->count('users');\n$totalManga = $db->count('manga');\n$totalEntries = $db->count('user_reading_progress');\n\n$recentUsers = $db->getRows(\n    \"SELECT id, username, email, created_at FROM users ORDER BY created_at DESC LIMIT 5\",\n    \"\"\n);\n\n$topGenres = $db->getRows(\n    \"SELECT \n        TRIM(SUBSTRING_INDEX(SUBSTRING_INDEX(category, ',', numbers.n), ',', -1)) as genre,\n        COUNT(*) as count\n    FROM manga\n    JOIN (SELECT 1 as n UNION SELECT 2 UNION SELECT 3 UNION SELECT 4 UNION SELECT 5) numbers\n    WHERE CHAR_LENGTH(category) - CHAR_LENGTH(REPLACE(category, ',', '')) >= numbers.n - 1\n    GROUP BY genre\n    ORDER BY count DESC\n    LIMIT 10\",\n    \"\"\n);\n\n?>\n<!DOCTYPE html>\n<html lang=\"en\">\n<head>\n    <meta charset=\"UTF-8\">\n    <meta name=\"viewport\" content=\"width=device-width, initial-scale=1.0\">\n    <title>Admin Dashboard - Manga Status Site</title>\n    <link href=\"https://fonts.googleapis.com/css2?family=Bebas+Neue&family=Zen+Kaku+Gothic+New:wght@400;500;700&display=swap\" rel=\"stylesheet\">\n    <style>\n        * {\n            margin: 0;\n            padding: 0;\n            box-sizing: border-box;\n        }\n        :root {\n            --paper: #f5efe3;\n            --ink: #141414;\n            --accent: #d7263d;\n            --accent-glow: #f2a900;\n            --text: #333;\n            --border: #ddd;\n        }\n        body {\n            font-family: 'Zen Kaku Gothic New', sans-serif;\n            background: var(--paper);\n            color: var(--ink);\n        }\n        .container {\n            max-width: 1400px;\n            margin: 0 auto;\n            padding: 20px;\n        }\n        h1 {\n            font-family: 'Bebas Neue', cursive;\n            font-size: 2.5em;\n            color: var(--accent);\n            margin-bottom: 20px;\n        }\n        h2 {\n            font-family: 'Bebas Neue', cursive;\n            font-size: 1.5em;\n            color: var(--accent);\n            margin-top: 20px;\n            margin-bottom: 15px;\n            border-bottom: 2px solid var(--accent);\n            padding-bottom: 10px;\n        }\n        .stats-grid {\n            display: grid;\n            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));\n            gap: 20px;\n            margin-bottom: 30px;\n        }\n        .stat-card {\n            background: white;\n            border: 2px solid var(--accent);\n            border-radius: 8px;\n            padding: 20px;\n            text-align: center;\n            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);\n        }\n        .stat-card h3 {\n            color: var(--accent-glow);\n            font-size: 0.9em;\n            margin-bottom: 10px;\n        }\n        .stat-value {\n            font-family: 'Bebas Neue', cursive;\n            font-size: 2.5em;\n            color: var(--accent);\n        }\n        .section {\n            background: white;\n            border: 2px solid var(--accent);\n            border-radius: 8px;\n            padding: 20px;\n            margin-bottom: 20px;\n            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);\n        }\n        table {\n            width: 100%;\n            border-collapse: collapse;\n            margin-top: 10px;\n        }\n        th {\n            background: #f5efe3;\n            border-bottom: 2px solid var(--accent);\n            padding: 10px;\n            text-align: left;\n            color: var(--accent);\n            font-weight: bold;\n        }\n        td {\n            border-bottom: 1px solid var(--border);\n            padding: 10px;\n        }\n        tr:hover {\n            background: #f9f9f9;\n        }\n        .badge {\n            display: inline-block;\n            padding: 4px 8px;\n            border-radius: 4px;\n            font-size: 0.85em;\n            font-weight: bold;\n        }\n        .badge-user {\n            background:#e3f2fd;\n            color: #1976d2;\n        }\n        .badge-manga {\n            background: #f3e5f5;\n            color: #7b1fa2;\n        }\n        .badge-entry {\n            background: #e8f5e9;\n            color: #388e3c;\n        }\n        .nav-links {\n            margin-bottom: 20px;\n        }\n        .nav-links a {\n            display: inline-block;\n            padding: 10px 20px;\n            background: var(--accent);\n            color: white;\n            text-decoration: none;\n            border-radius: 4px;\n            margin-right: 10px;\n            margin-bottom: 10px;\n            transition: background 0.3s;\n        }\n        .nav-links a:hover {\n            background: var(--accent-glow);\n        }\n    </style>\n</head>\n<body>\n    <div class=\"container\">\n        <div class=\"nav-links\">\n            <a href=\"home.php\">‚Üê Back to Site</a>\n        </div>\n\n        <h1>üë®‚Äçüíº Admin Dashboard</h1>\n        \n        <div class=\"stats-grid\">\n            <div class=\"stat-card\">\n                <h3>Total Users</h3>\n                <div class=\"stat-value\"><?php echo $totalUsers; ?></div>\n                <span class=\"badge badge-user\">Users</span>\n            </div>\n            <div class=\"stat-card\">\n                <h3>Total Manga</h3>\n                <div class=\"stat-value\"><?php echo $totalManga; ?></div>\n                <span class=\"badge badge-manga\">Manga</span>\n            </div>\n            <div class=\"stat-card\">\n                <h3>Collection Entries</h3>\n                <div class=\"stat-value\"><?php echo $totalEntries; ?></div>\n                <span class=\"badge badge-entry\">Entries</span>\n            </div>\n        </div>\n\n        <div class=\"section\">\n            <h2>üìä Top Genres</h2>\n            <table>\n                <thead>\n                    <tr>\n                        <th>Genre</th>\n                        <th>Count</th>\n                    </tr>\n                </thead>\n                <tbody>\n                    <?php foreach ($topGenres as $genre): ?>\n                    <tr>\n                        <td><?php echo htmlspecialchars($genre['genre']); ?></td>\n                        <td><?php echo $genre['count']; ?></td>\n                    </tr>\n                    <?php endforeach; ?>\n                </tbody>\n            </table>\n        </div>\n\n        <div class=\"section\">\n            <h2>üë• Recent Users</h2>\n            <table>\n                <thead>\n                    <tr>\n                        <th>ID</th>\n                        <th>Username</th>\n                        <th>Email</th>\n                        <th>Joined</th>\n                    </tr>\n                </thead>\n                <tbody>\n                    <?php foreach ($recentUsers as $user): ?>\n                    <tr>\n                        <td><?php echo $user['id']; ?></td>\n                        <td><?php echo htmlspecialchars($user['username']); ?></td>\n                        <td><?php echo htmlspecialchars($user['email']); ?></td>\n                        <td><?php echo date('M d, Y', strtotime($user['created_at'])); ?></td>\n                    </tr>\n                    <?php endforeach; ?>\n                </tbody>\n            </table>\n        </div>\n\n        <div class=\"section\">\n            <h2>‚öôÔ∏è Admin Tools</h2>\n            <p style=\"margin-top: 10px;\">\n                <strong>Available Utilities:</strong><br>\n                ‚Ä¢ User Management<br>\n                ‚Ä¢ Manga Database Administration<br>\n                ‚Ä¢ System Logs & Analytics<br>\n                ‚Ä¢ Database Maintenance<br>\n                ‚Ä¢ API Documentation: <a href=\"api_docs.php\" style=\"color: var(--accent);\">View API Docs</a>\n            </p>\n        </div>\n    </div>\n</body>\n</html>\n"