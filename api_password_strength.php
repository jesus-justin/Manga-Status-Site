<?php\n/**\n * Password Strength Meter API\n * \n * Provides real-time password strength validation\n */\n\nrequire_once 'config/constants.php';\nrequire_once 'src/Response.php';\nrequire_once 'src/Validator.php';\n\nheader('Content-Type: application/json');\n\nif ($_SERVER['REQUEST_METHOD'] !== 'POST') {\n    http_response_code(405);\n    echo json_encode(['success' => false, 'error' => 'Method not allowed']);\n    exit;\n}\n\n$input = json_decode(file_get_contents('php://input'), true);\n$password = $input['password'] ?? '';\n\nif (empty($password)) {\n    http_response_code(400);\n    echo json_encode(['success' => false, 'error' => 'Password required']);\n    exit;\n}\n\n$validator = new Validator();\n$strength = 0;\n$feedback = [];\n\n// Length checks\nif (strlen($password) >= 8) {\n    $strength += 20;\n} else {\n    $feedback[] = 'Password must be at least 8 characters';\n}\n\nif (strlen($password) >= 12) {\n    $strength += 10;\n}\n\nif (strlen($password) >= 16) {\n    $strength += 10;\n}\n\n// Character type checks\nif (preg_match('/[a-z]/', $password)) {\n    $strength += 15;\n} else {\n    $feedback[] = 'Add lowercase letters';\n}\n\nif (preg_match('/[A-Z]/', $password)) {\n    $strength += 15;\n} else {\n    $feedback[] = 'Add uppercase letters';\n}\n\nif (preg_match('/[0-9]/', $password)) {\n    $strength += 15;\n} else {\n    $feedback[] = 'Add numbers';\n}\n\nif (preg_match('/[!@#$%^&*()_+\\-=\\[\\]{};:'\\'\"<>,.?/]/', $password)) {\n    $strength += 15;\n} else {\n    $feedback[] = 'Add special characters';\n}\n\n// Common patterns to avoid\nif (preg_match('/^[0-9]+$/', $password)) {\n    $strength -= 20;\n    $feedback[] = 'Avoid using only numbers';\n}\n\nif (preg_match('/^[a-zA-Z]+$/', $password)) {\n    $strength -= 20;\n    $feedback[] = 'Avoid using only letters';\n}\n\nif (preg_match('/(.)(\\1{2,})/', $password)) {\n    $strength -= 10;\n    $feedback[] = 'Avoid repeating characters';\n}\n\n// Check for common patterns\n$commonPatterns = ['password', 'qwerty', '123456', 'admin', 'letmein', 'welcome', 'monkey', 'dragon', 'batman'];\nforeach ($commonPatterns as $pattern) {\n    if (stripos($password, $pattern) !== false) {\n        $strength -= 15;\n        $feedback[] = 'Avoid common patterns';\n        break;\n    }\n}\n\n// Ensure strength is between 0-100\n$strength = max(0, min(100, $strength));\n\n// Determine strength level\nif ($strength < 30) {\n    $level = 'weak';\n    $color = '#f44336';\n} elseif ($strength < 60) {\n    $level = 'fair';\n    $color = '#ff9800';\n} elseif ($strength < 80) {\n    $level = 'good';\n    $color = '#4caf50';\n} else {\n    $level = 'strong';\n    $color = '#2196f3';\n}\n\necho json_encode([\n    'success' => true,\n    'strength' => $strength,\n    'level' => $level,\n    'color' => $color,\n    'feedback' => $feedback\n]);\n\n?>\n"